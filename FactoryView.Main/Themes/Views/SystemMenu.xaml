<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:views="clr-namespace:FactoryView.Main.UI.Views"
                    xmlns:models="clr-namespace:FactoryView.Main.Local.Models">

    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

    <Style TargetType="{x:Type views:SystemMenu}">
        <Setter Property="Background" Value="#F5F5F5"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type views:SystemMenu}">
                    <Border Background="{TemplateBinding Background}" Padding="10">
                        <Grid>
                            <Grid.RowDefinitions>
                                <!-- 툴바 영역 -->
                                <RowDefinition Height="Auto"/>
                                <!-- 그리드 영역 -->
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- 툴바 영역 -->
                            <Border Grid.Row="0" Background="White"
                                    BorderBrush="#DDDDDD" BorderThickness="1"
                                    CornerRadius="4" Padding="10,8" Margin="0,0,0,10">
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="조회" Width="70" Height="28"
                                            Background="#104F89" Foreground="White"
                                            BorderThickness="0" Cursor="Hand"
                                            Command="{Binding SearchCommand}"/>
                                </StackPanel>
                            </Border>

                            <!-- 3단계 그리드 영역 -->
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- 대메뉴 (Level 1) -->
                                <Border Grid.Column="0" Background="White"
                                        BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="4">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <Border Grid.Row="0" Background="#104F89" Padding="10,8">
                                            <TextBlock Text="대메뉴" Foreground="White"
                                                       FontWeight="Bold" FontSize="14"/>
                                        </Border>

                                        <DataGrid Grid.Row="1"
                                                  ItemsSource="{Binding Level1MenuList}"
                                                  SelectedItem="{Binding SelectedLevel1Menu}"
                                                  AutoGenerateColumns="False"
                                                  IsReadOnly="True"
                                                  CanUserAddRows="False"
                                                  SelectionMode="Single"
                                                  HeadersVisibility="Column"
                                                  GridLinesVisibility="Horizontal"
                                                  BorderThickness="0"
                                                  RowHeight="28"
                                                  ColumnHeaderHeight="30"
                                                  AlternatingRowBackground="#F9F9F9">
                                            <DataGrid.ColumnHeaderStyle>
                                                <Style TargetType="DataGridColumnHeader">
                                                    <Setter Property="Background" Value="#E8E8E8"/>
                                                    <Setter Property="Foreground" Value="#333333"/>
                                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                                    <Setter Property="Padding" Value="8,0"/>
                                                    <Setter Property="BorderBrush" Value="#CCCCCC"/>
                                                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                                </Style>
                                            </DataGrid.ColumnHeaderStyle>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="순번" Binding="{Binding MenuSeq}" Width="50"/>
                                                <DataGridTextColumn Header="메뉴ID" Binding="{Binding MenuId}" Width="80"/>
                                                <DataGridTextColumn Header="메뉴명" Binding="{Binding LabelKR}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Border>

                                <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="Transparent"/>

                                <!-- 중메뉴 (Level 2) -->
                                <Border Grid.Column="2" Background="White"
                                        BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="4">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <Border Grid.Row="0" Background="#104F89" Padding="10,8">
                                            <TextBlock Text="중메뉴" Foreground="White"
                                                       FontWeight="Bold" FontSize="14"/>
                                        </Border>

                                        <!-- 중메뉴 버튼 -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5" HorizontalAlignment="Right">
                                            <Button Content="+" Width="28" Height="24" Margin="2,0"
                                                    Background="#28A745" Foreground="White" BorderThickness="0"
                                                    Command="{Binding AddLevel2Command}" ToolTip="추가"/>
                                            <Button Content="-" Width="28" Height="24" Margin="2,0"
                                                    Background="#DC3545" Foreground="White" BorderThickness="0"
                                                    Command="{Binding DeleteLevel2Command}" ToolTip="삭제"/>
                                            <Button Content="Up" Width="35" Height="24" Margin="2,0"
                                                    Background="#6C757D" Foreground="White" BorderThickness="0"
                                                    Command="{Binding MoveUpLevel2Command}" ToolTip="위로"/>
                                            <Button Content="Dn" Width="35" Height="24" Margin="2,0"
                                                    Background="#6C757D" Foreground="White" BorderThickness="0"
                                                    Command="{Binding MoveDownLevel2Command}" ToolTip="아래로"/>
                                            <Button Content="저장" Width="50" Height="24" Margin="2,0"
                                                    Background="#104F89" Foreground="White" BorderThickness="0"
                                                    Command="{Binding SaveLevel2Command}"/>
                                        </StackPanel>

                                        <DataGrid Grid.Row="2"
                                                  ItemsSource="{Binding Level2MenuList}"
                                                  SelectedItem="{Binding SelectedLevel2Menu}"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  SelectionMode="Single"
                                                  HeadersVisibility="Column"
                                                  GridLinesVisibility="All"
                                                  BorderThickness="0"
                                                  RowHeight="28"
                                                  ColumnHeaderHeight="30"
                                                  AlternatingRowBackground="#F9F9F9">
                                            <DataGrid.ColumnHeaderStyle>
                                                <Style TargetType="DataGridColumnHeader">
                                                    <Setter Property="Background" Value="#E8E8E8"/>
                                                    <Setter Property="Foreground" Value="#333333"/>
                                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                                    <Setter Property="Padding" Value="8,0"/>
                                                    <Setter Property="BorderBrush" Value="#CCCCCC"/>
                                                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                                </Style>
                                            </DataGrid.ColumnHeaderStyle>
                                            <DataGrid.RowStyle>
                                                <Style TargetType="DataGridRow">
                                                    <Setter Property="Background" Value="White"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RowState}" Value="{x:Static models:RowState.Insert}">
                                                            <Setter Property="Background" Value="#B7F0B1"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.RowStyle>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="순번" Binding="{Binding MenuSeq}" Width="50" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="메뉴ID" Binding="{Binding MenuId, UpdateSourceTrigger=PropertyChanged}" Width="80"/>
                                                <DataGridTextColumn Header="메뉴명" Binding="{Binding LabelKR, UpdateSourceTrigger=PropertyChanged}" Width="100"/>
                                                <DataGridTextColumn Header="폼이름" Binding="{Binding FormName, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Border>

                                <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Background="Transparent"/>

                                <!-- 소메뉴 (Level 3) -->
                                <Border Grid.Column="4" Background="White"
                                        BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="4">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <Border Grid.Row="0" Background="#104F89" Padding="10,8">
                                            <TextBlock Text="소메뉴" Foreground="White"
                                                       FontWeight="Bold" FontSize="14"/>
                                        </Border>

                                        <!-- 소메뉴 버튼 -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5" HorizontalAlignment="Right">
                                            <Button Content="+" Width="28" Height="24" Margin="2,0"
                                                    Background="#28A745" Foreground="White" BorderThickness="0"
                                                    Command="{Binding AddLevel3Command}" ToolTip="추가"/>
                                            <Button Content="-" Width="28" Height="24" Margin="2,0"
                                                    Background="#DC3545" Foreground="White" BorderThickness="0"
                                                    Command="{Binding DeleteLevel3Command}" ToolTip="삭제"/>
                                            <Button Content="Up" Width="35" Height="24" Margin="2,0"
                                                    Background="#6C757D" Foreground="White" BorderThickness="0"
                                                    Command="{Binding MoveUpLevel3Command}" ToolTip="위로"/>
                                            <Button Content="Dn" Width="35" Height="24" Margin="2,0"
                                                    Background="#6C757D" Foreground="White" BorderThickness="0"
                                                    Command="{Binding MoveDownLevel3Command}" ToolTip="아래로"/>
                                            <Button Content="저장" Width="50" Height="24" Margin="2,0"
                                                    Background="#104F89" Foreground="White" BorderThickness="0"
                                                    Command="{Binding SaveLevel3Command}"/>
                                        </StackPanel>

                                        <DataGrid Grid.Row="2"
                                                  ItemsSource="{Binding Level3MenuList}"
                                                  SelectedItem="{Binding SelectedLevel3Menu}"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  SelectionMode="Single"
                                                  HeadersVisibility="Column"
                                                  GridLinesVisibility="All"
                                                  BorderThickness="0"
                                                  RowHeight="28"
                                                  ColumnHeaderHeight="30"
                                                  AlternatingRowBackground="#F9F9F9">
                                            <DataGrid.ColumnHeaderStyle>
                                                <Style TargetType="DataGridColumnHeader">
                                                    <Setter Property="Background" Value="#E8E8E8"/>
                                                    <Setter Property="Foreground" Value="#333333"/>
                                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                                    <Setter Property="Padding" Value="8,0"/>
                                                    <Setter Property="BorderBrush" Value="#CCCCCC"/>
                                                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                                </Style>
                                            </DataGrid.ColumnHeaderStyle>
                                            <DataGrid.RowStyle>
                                                <Style TargetType="DataGridRow">
                                                    <Setter Property="Background" Value="White"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RowState}" Value="{x:Static models:RowState.Insert}">
                                                            <Setter Property="Background" Value="#B7F0B1"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.RowStyle>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="순번" Binding="{Binding MenuSeq}" Width="50" IsReadOnly="True"/>
                                                <DataGridTextColumn Header="메뉴ID" Binding="{Binding MenuId, UpdateSourceTrigger=PropertyChanged}" Width="80"/>
                                                <DataGridTextColumn Header="메뉴명" Binding="{Binding LabelKR, UpdateSourceTrigger=PropertyChanged}" Width="100"/>
                                                <DataGridTextColumn Header="폼이름" Binding="{Binding FormName, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </Border>
                            </Grid>

                            <!-- 로딩 오버레이 -->
                            <Border Grid.RowSpan="2" Background="#80000000"
                                    Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="로딩 중..." Foreground="White" FontSize="16"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
